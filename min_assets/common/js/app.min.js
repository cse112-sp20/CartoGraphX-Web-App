const getUiConfig=()=>({callbacks:{signInSuccessWithAuthResult:a=>(a.user&&handleSignedInUser(a.user),a.additionalUserInfo.isNewUser&&(document.getElementById("is-new-user").textContent="Welcome to CartoGraphx !",document.getElementById("new-user-link").innerHTML=`<a href="https://marketplace.visualstudio.com/items?itemName=remote13.extension" target="_blank">VS Code extension</a>`,document.getElementById("new-user-info").style.display="flex"),!1)},signInOptions:[{provider:firebase.auth.EmailAuthProvider.PROVIDER_ID,requireDisplayName:!0}],credentialHelper:CLIENT_ID&&"YOUR_OAUTH_CLIENT_ID"!=CLIENT_ID?firebaseui.auth.CredentialHelper.GOOGLE_YOLO:firebaseui.auth.CredentialHelper.ACCOUNT_CHOOSER_COM});var ui=new firebaseui.auth.AuthUI(firebase.auth()),handleSignedInUser=a=>{document.getElementById("user-signed-in").style.display="block",document.getElementById("user-signed-out").style.display="none",document.getElementById("name").textContent=a.displayName,document.getElementById("email").textContent=a.email,document.getElementById("phone").textContent=a.phoneNumber,document.getElementById("userPage").textContent="Profile",document.getElementById("mapManagePage").textContent="Manage Maps",fetchMaps()};const baseUrl="http://localhost:5000/remote-13/us-central1/api",fetchMaps=()=>{firebase.auth().currentUser.getIdToken(!0).then(function(a){fetch("http://localhost:5000/remote-13/us-central1/api/map/showMaps",{headers:{idToken:a}}).then(a=>a.json()).then(a=>{for(const b=document.getElementById("team-maps");b.firstChild;)b.removeChild(b.firstChild);var b=[];for(var c in a.result)b.push(c);b.sort(),createTree(b[0],firebase),addElementsToUl(b)}).catch(a=>{console.log(a)})})},addElementsToUl=a=>{for(i=0;i<a.length;i++){var b=document.createElement("li");b.id=0==i?"mapkey_listitem-active":"mapkey_listitem",b.appendChild(document.createTextNode(a[i])),document.getElementById("team-maps").appendChild(b),b.addEventListener("click",a=>{const b=document.getElementById("team-maps").childNodes;b.forEach(b=>{b.target?.innerText!==a.target.innerText&&(b.id="mapkey_listitem")}),a.target.id="mapkey_listitem-active",createTree(a.target.innerText,firebase)})}},addMap=a=>{console.log(JSON.stringify({mapKey:a})),firebase.auth().currentUser.getIdToken(!0).then(function(b){fetch("http://localhost:5000/remote-13/us-central1/api/map/joinMap",{method:"POST",headers:{idToken:b},body:JSON.stringify({mapKey:a})}).catch(a=>{console.log(a)}),fetchMaps()})};var handleSignedOutUser=()=>{document.getElementById("user-signed-in").style.display="none",document.getElementById("user-signed-out").style.display="block",document.getElementById("userPage").innerHTML=null,document.getElementById("mapManagePage").innerHTML=null,ui.start("#firebaseui-container",getUiConfig())};firebase.auth().onAuthStateChanged(a=>{document.getElementById("loading").style.display="none",document.getElementById("loaded").style.display="block",a?handleSignedInUser(a):handleSignedOutUser()});var deleteAccount=()=>{firebase.auth().currentUser.delete().then(a=>{console.log(a),setTimeout(()=>{alert("Your account was successfully deleted.")},1)}).catch(a=>{"auth/requires-recent-login"==a.code&&firebase.auth().signOut().then(()=>{setTimeout(()=>{alert("Please sign in again to delete your account.")},1)})})};const toggleNav=()=>{document.querySelector(".burger i").classList.toggle("fa-bars"),document.querySelector(".burger i").classList.toggle("fa-times"),document.querySelector(".nav").classList.toggle("nav-active")};var initApp=()=>{document.getElementById("sign-out").addEventListener("click",()=>{firebase.auth().signOut()}),document.getElementById("delete-account").addEventListener("click",()=>{deleteAccount()}),document.addEventListener("submit",a=>{a.preventDefault();const b=document.querySelector("#mapForm");let c=b.mapKey.value;addMap(c),b.mapKey.value=""}),document.getElementById("large-sign-button").addEventListener("click",()=>{document.getElementById("large-sign-button").style.display="none",document.getElementById("firebaseui-spa").style.display="block"}),document.querySelector(".burger i").addEventListener("click",()=>{toggleNav()}),window.onclick=a=>{const b=document.getElementById("user-profile"),c=document.getElementById("userPage");a.target===b||b.contains(a.target)||a.target===c||(document.getElementById("user-profile").style.display="none")},document.getElementById("userPage").addEventListener("click",()=>{document.getElementById("mapmanage-container").style.display="none",document.getElementById("user-profile").style.display="block"===document.getElementById("user-profile").style.display?"none":"block",toggleNav()}),document.getElementById("mapManagePage").addEventListener("click",()=>{document.getElementById("user-profile").style.display="none",document.getElementById("mapmanage-container").style.display="flex"===document.getElementById("mapmanage-container").style.display?"none":"flex",toggleNav()}),document.querySelector("#manage-close-button i").addEventListener("click",()=>{document.getElementById("mapmanage-container").style.display="none"}),document.querySelectorAll("#visualization-choices button").forEach(a=>{a.addEventListener("click",a=>{const b=document.getElementById("visualization-choices").childNodes;b.forEach(b=>{b.target?.innerText!==a.target.innerText&&(b.id="visualization-choice",b.value&&(document.getElementById(b.value).style.display="none"))}),a.target.id="visualization-choice-active",document.getElementById(a.target.value).style.display="flex"})})};window.addEventListener("load",initApp);